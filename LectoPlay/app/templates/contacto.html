{% extends 'home.html' %}
{% load static %}

{% block title %}Contacto | LectoPlay{% endblock %}

{% block content %}

<div class="container contact-section">
    
    {% if error %}
        <div class="alert alert-danger rounded-4 mb-4 text-center">
            âš ï¸ {{ error }}
        </div>
    {% endif %}

    <div class="row align-items-center g-5">
        
        <div class="col-lg-5 contact-info-box">
            <h1 class="contact-title">Â¡Estamos aquÃ­ para escucharte! ğŸ’Œ</h1>
            <p class="contact-desc">
                En <strong>LectoPlay</strong> creemos que la comunicaciÃ³n es clave. Ya sea que tengas una idea brillante, una duda sobre los juegos o simplemente quieras saludar, Â¡escrÃ­benos!
            </p>
            
            <ul class="contact-features">
                <li>
                    <div class="feature-icon-circle" style="background: #a2d2ff;">ğŸ’¡</div>
                    <span>Sugerencias de nuevos juegos</span>
                </li>
                <li>
                    <div class="feature-icon-circle" style="background: #ffafcc;">ğŸ› ï¸</div>
                    <span>Soporte tÃ©cnico y ayuda</span>
                </li>
                <li>
                    <div class="feature-icon-circle" style="background: #ffd166;">ğŸ«</div>
                    <span>InformaciÃ³n para escuelas</span>
                </li>
            </ul>

            <div class="text-center mt-5 d-none d-md-block">
                <img src="{% static 'css/osito.png' %}" alt="Oso saludando" style="max-width: 200px; border-radius: 20px; transform: rotate(-5deg);">
            </div>
        </div>

        <div class="col-lg-7">
            <div class="contact-card">
                <h3 class="text-center mb-4" style="color: #219ebc; font-weight: 700;">EnvÃ­anos un mensaje</h3>
                
                <form action="{% url 'contacto' %}" method="post">
                    {% csrf_token %}
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="name" class="form-label-styled">ğŸ‘¦ Tu Nombre</label>
                            <input type="text" id="name" name="name" class="input-styled" placeholder="Ej: Juan PÃ©rez" required>
                        </div>

                        <div class="col-md-6 mb-3">
                            <label for="fecha" class="form-label-styled">ğŸ“… Fecha</label>
                            <input type="date" id="fecha" name="fecha" class="input-styled" required>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="email" class="form-label-styled">ğŸ“§ Correo ElectrÃ³nico</label>
                        <input type="email" id="email" name="email" class="input-styled" placeholder="correo@ejemplo.com" required>
                    </div>

                    <div class="mb-4">
                        <label for="message" class="form-label-styled">ğŸ’¬ Â¿CÃ³mo podemos ayudarte?</label>
                        <textarea id="message" name="message" rows="5" class="input-styled" placeholder="CuÃ©ntanos todo aquÃ­..." required></textarea>
                    </div>

                    <button type="submit" class="btn-send-msg">Enviar Mensaje ğŸš€</button>
                </form>
            </div>
        </div>

    </div>
</div>

{% if success %}
<div id="modal" class="modal-overlay" onclick="closeModal()">
    <div class="modal-content-box" onclick="event.stopPropagation()">
        
        <h2 class="modal-title">Â¡Mensaje enviado! ğŸ‰</h2>
        <p style="color:#555; margin-bottom:20px;">Hemos recibido tu consulta y generado un ticket Ãºnico.</p>

        <div class="alert-warning-box">
            <strong>âš ï¸ IMPORTANTE:</strong><br>
            Para leer la respuesta del administrador en el futuro, 
            <strong>guarda el siguiente enlace</strong>:
        </div>

        <div style="margin-bottom: 25px;">
            <input type="text" 
                   value="{{ request.scheme }}://{{ request.get_host }}{% url 'usuario_ver_ticket' ticket_codigo %}" 
                   readonly 
                   onclick="this.select();"
                   class="url-input-readonly">
            <small style="color: #888; display: block; margin-top: 5px; font-size: 0.8rem;">(Haz clic para seleccionar)</small>
        </div>

        <a href="{% url 'usuario_ver_ticket' ticket_codigo %}" class="btn-modal-chat">
            ğŸ’¬ Ir al chat ahora
        </a>

        <button type="button" onclick="closeModal()" class="btn-modal-close">
            Cerrar ventana
        </button>

    </div>
</div>
{% endif %}

{% endblock %}

{% block extra_js %}
<script>
    function closeModal() {
        document.getElementById('modal').style.display = 'none';
    }

    // Script opcional para poner la fecha de hoy automÃ¡ticamente
    document.addEventListener('DOMContentLoaded', function() {
        const dateInput = document.getElementById('fecha');
        if (dateInput && !dateInput.value) {
            dateInput.valueAsDate = new Date();
        }
    });
</script>
{% endblock %}