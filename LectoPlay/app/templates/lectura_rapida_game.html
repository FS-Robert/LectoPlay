{% extends "home.html" %}

{% block title %}Lectura R√°pida{% endblock %}

{% block content %}
<div class="ejercicios">
    <h1>üìñ Lectura R√°pida</h1>
    <p>Lee frases cortas y responde preguntas para mejorar tu comprensi√≥n.</p>

    {% if not categoria_actual %}
        <!-- PASO 1: ELEGIR CATEGOR√çA -->
        <h2>Elige una categor√≠a</h2>
        <div class="cards">
            {% for cat in categorias %}
                <div class="card">
                    <h3>{{ cat }}</h3>
                    <p>Frases y preguntas relacionadas con <strong>{{ cat }}</strong>.</p>
                    <form method="get">
                        <input type="hidden" name="categoria" value="{{ cat }}">
                        <button type="submit" class="btn">Empezar</button>
                    </form>
                </div>
            {% endfor %}
        </div>

    {% else %}
    <div class="lectura-bg">

        <div class="score-pretty">
            Aciertos: {{ aciertos }} / {{ intentos }}
        </div>

        <div class="lectura-card">

            <h2 class="titulo-categoria">Categor√≠a: {{ categoria_actual }}</h2>

            <div class="frase-box-pretty">
                <strong>Frase:</strong>
                <p>{{ frase }}</p>
            </div>

            <p><strong>Pregunta:</strong> {{ pregunta }}</p>

            <!-- ==== FORMULARIO √öNICO: OPCIONES + BOTONES ==== -->
            <form method="post">
                {% csrf_token %}

                <!-- Opciones de respuesta -->
                <div class="opciones-container">
                    {% for opcion in opciones %}
                        <label class="opcion-linea">
                            <input type="radio" name="respuesta" value="{{ opcion }}" required>
                            {{ opcion }}
                        </label>
                    {% endfor %}
                </div>

                <!-- Datos ocultos -->
                <input type="hidden" name="correcta" value="{{ correcta }}">
                <input type="hidden" name="categoria" value="{{ categoria_actual }}">

                <!-- Botones en una sola l√≠nea -->
                <div class="btn-row">
                    <button type="submit" class="btn" name="action" value="responder">
                        Responder
                    </button>

                    <button type="submit" class="btn" name="action" value="otra">
                        Otra frase
                    </button>

                    <a href="{% url 'lectura_rapida_game' %}" class="btn">
                        Cambiar categor√≠a
                    </a>
                </div>
            </form>

            {% if feedback %}
                <p class="feedback">{{ feedback }}</p>
            {% endif %}

        </div>

    </div>
    {% endif %}
</div>
{% endblock %}
